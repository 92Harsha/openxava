<?xml version="1.0"?>

<!--
	Este ant permite crear un nuevo proyecto OpenXava de forma sencilla.
	Simplemente pon valor a las propiedades y ejecuta la tarea crearNuevoProyecto.
-->

<project name="CrearNuevoProyecto" default="crearNuevoProyecto" basedir=".">

	<input addproperty="proyecto" message="¿Cuál es el nombre de tu proyecto?"/>
	<property name="fuentedatos" value="${proyecto}DS"/>	
	<property name="basedatos" value="${proyecto}DB"/> <!-- tmp -->
	<property name="esquema" value="${proyecto}"/>
	
	<!-- tmp ini -->
	<target name="definirPaquete">
		<script language="javascript">
			var paquete = project.getProperty("proyecto").replace(/ /g,'').toLowerCase();
			project.setProperty("paquete", paquete); 
		 </script>
	</target>
	<!-- tmp fin -->
		
	<!-- tmp
	<target name="crearNuevoProyecto">
	-->
	<!-- tmp ini -->
	<target name="crearNuevoProyecto" depends="definirPaquete">
	<!-- tmp fin -->	
		<mkdir dir="../${proyecto}"/>
		<copy todir="../${proyecto}" overwrite="true">
			<fileset dir="project-templates/es"/>
	    	<filterset>	    	
				<filter token="proyecto" value="${proyecto}"/>
	    		<filter token="paquete" value="${paquete}"/> 
	    		<filter token="fuentedatos" value="${fuentedatos}"/>
	    		<filter token="basedatos" value="${basedatos}"/> 
	    		<filter token="esquema" value="${esquema}"/>
			</filterset>
		</copy>						
		<move file="../${proyecto}/.project.template" 
			tofile="../${proyecto}/.project" />			
		<move file="../${proyecto}/xava/aplicacion.xml.plantilla" 
			tofile="../${proyecto}/xava/aplicacion.xml" />
		<move file="../${proyecto}/xava/controladores.xml.plantilla" 
			tofile="../${proyecto}/xava/controladores.xml" />
		<move file="../${proyecto}/i18n/Etiquetas_es.properties.plantilla" 
			tofile="../${proyecto}/i18n/Etiquetas${proyecto}_es.properties" />				
		<move file="../${proyecto}/i18n/Mensajes_es.properties.plantilla" 
			tofile="../${proyecto}/i18n/Mensajes${proyecto}_es.properties" />
		<!-- tmp ini -->
		<move file="../${proyecto}/src/_run/LanzadorAplicacion.java" 
			tofile="../${proyecto}/src/_run/${proyecto}.java" />
		<move file="../${proyecto}/src/com/tuempresa/tuaplicacion/modelo/TuPrimeraEntidad.java" 
			tofile="../${proyecto}/src/com/tuempresa/${paquete}/modelo/TuPrimeraEntidad.java" />
		<delete dir="../${proyecto}/src/com/tuempresa/tuaplicacion" failonerror="false"/>		
		<delete file="../${proyecto}/data/data.txt"/>
		<!-- tmp fin -->		
		<!-- tmp
		<delete file="../${proyecto}/src/src.txt"/>
		-->
		<delete dir="../${proyecto}/bin" failonerror="false"/>
		<ant antfile="../OpenXava/build.xml" target="updateOX">
			<property name="project" value="${proyecto}"/>
		</ant>	
	</target>
					
</project>
